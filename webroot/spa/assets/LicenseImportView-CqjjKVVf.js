import{f as V,c as r,a as s,d as a,b as m,w as v,p as B,v as $,F as j,h as L,E as h,A as x,t as p,l as C,j as i,m as A,o as d}from"./index-CHWeGoxB.js";import{a as w}from"./admin-CUXU3qYV.js";import{A as M}from"./AppCard-DwTApDbO.js";const z={class:"admin-license-import"},D={class:"flex justify-between items-center mb-6"},N={class:"flex items-center gap-4"},U={class:"max-w-2xl mx-auto"},_={class:"mb-6"},E=["value"],P={class:"mb-8"},R={key:0},T={key:1,class:"flex flex-col items-center"},q={class:"font-medium mb-1"},K={class:"text-xs text-secondary mb-4"},G={key:0,class:"bg-red-500/10 border border-red-500/20 text-red-500 p-4 rounded-xl mb-6 text-sm"},H={key:1,class:"bg-green-500/10 border border-green-500/20 text-green-400 p-4 rounded-xl mb-6 text-sm flex justify-between items-center"},J={class:"border-t pt-6 flex justify-end gap-4 mt-8"},Y={__name:"LicenseImportView",setup(O){A();const g=i(null),k=i([]),u=i(""),n=i(null),f=i(!1),o=i(""),c=i(""),I=async()=>{try{const t=await w.getInstances();t.success&&(k.value=t.instances)}catch{o.value="Failed to load instances"}};V(()=>{I()});const F=t=>{const e=t.target.files[0];e&&(n.value=e,o.value="",c.value="")},y=()=>{n.value=null,g.value&&(g.value.value="")},S=async()=>{var e,l;if(!u.value){o.value="Please select a target instance";return}if(!n.value){o.value="Please select a CSV file";return}o.value="",c.value="",f.value=!0;const t=new FormData;t.append("file",n.value),t.append("instance_id",u.value);try{const b=await w.importLicenses(t);b.success&&(c.value=b.message||"Import successful",y())}catch(b){o.value=((l=(e=b.response)==null?void 0:e.data)==null?void 0:l.message)||"Failed to upload CSV"}finally{f.value=!1}};return(t,e)=>(d(),r("div",z,[s("div",D,[s("div",N,[s("button",{onClick:e[0]||(e[0]=l=>t.$router.push("/admin/licenses")),class:"btn btn-secondary p-2"},[...e[5]||(e[5]=[s("svg",{class:"icon mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),a(" Back ",-1)])]),e[6]||(e[6]=s("h1",{class:"text-2xl font-bold font-heading"},"Import Licenses",-1))])]),s("div",U,[m(M,null,{default:v(()=>[s("div",_,[e[8]||(e[8]=s("h3",{class:"text-lg font-semibold mb-2"},"1. Select Target Instance",-1)),e[9]||(e[9]=s("p",{class:"text-sm text-[var(--text-secondary)] mb-4"},"Choose the application instance where these licenses will be loaded.",-1)),B(s("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),class:"form-select",required:""},[e[7]||(e[7]=s("option",{value:"",disabled:""},"-- Select an Instance --",-1)),(d(!0),r(j,null,L(k.value,l=>(d(),r("option",{key:l.id,value:l.id},p(l.name),9,E))),128))],512),[[$,u.value]])]),s("div",P,[e[13]||(e[13]=s("h3",{class:"text-lg font-semibold mb-2"},"2. Upload CSV File",-1)),e[14]||(e[14]=s("p",{class:"text-sm text-[var(--text-secondary)] mb-4"},[a("Upload a CSV containing "),s("code",null,"email"),a(" and "),s("code",null,"name"),a(" columns.")],-1)),s("div",{class:"border-2 border-dashed border-[var(--border-subtle)] p-8 text-center transition-colors",style:h({borderRadius:"12px",borderColor:n.value?"var(--primary)":"var(--border-subtle)",backgroundColor:n.value?"rgba(193, 255, 114, 0.05)":"rgba(0,0,0,0.1)"})},[s("input",{type:"file",ref_key:"fileInput",ref:g,style:{display:"none"},accept:".csv",onChange:F},null,544),n.value?(d(),r("div",T,[e[12]||(e[12]=s("svg",{class:"icon-lg text-primary mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("div",q,p(n.value.name),1),s("div",K,p((n.value.size/1024).toFixed(1))+" KB",1),s("button",{onClick:y,class:"text-sm"},"Select different file")])):(d(),r("div",R,[e[11]||(e[11]=s("svg",{class:"mx-auto icon-lg text-secondary mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),m(x,{variant:"secondary",onClick:e[2]||(e[2]=l=>t.$refs.fileInput.click())},{default:v(()=>[...e[10]||(e[10]=[a("Browse Files",-1)])]),_:1})]))],4)]),o.value?(d(),r("div",G,p(o.value),1)):C("",!0),c.value?(d(),r("div",H,[s("span",null,p(c.value),1),m(x,{size:"sm",onClick:e[3]||(e[3]=l=>t.$router.push("/admin/licenses"))},{default:v(()=>[...e[15]||(e[15]=[a("View Licenses",-1)])]),_:1})])):C("",!0),s("div",J,[m(x,{variant:"secondary",onClick:e[4]||(e[4]=l=>t.$router.push("/admin/licenses"))},{default:v(()=>[...e[16]||(e[16]=[a("Cancel",-1)])]),_:1}),m(x,{onClick:S,disabled:!u.value||!n.value||f.value,loading:f.value},{default:v(()=>[...e[17]||(e[17]=[a(" Import Licenses ",-1)])]),_:1},8,["disabled","loading"])])]),_:1})])]))}};export{Y as default};
